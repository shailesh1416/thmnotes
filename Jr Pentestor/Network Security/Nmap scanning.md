# Network Security
## Active Scanning
### Nmap Scanning
#### Nmap Live Host Discovery
#### Nmap Basic Port Scanning
#### Advanced Port Scanning
     What would happen if we send a TCP packet, which is not part of any ongoing TCP connection, with one or more flags set.

- Null Scan\
    `nmap -sN MACHINE_IP`
    - TCP No flag set
    - No rsponse : Port is open
    - Response : Open | Filtered
- FIN Scan
    `nmap -sF MACHINE_IP`
    - TCP FIN flag set
    - No rsponse : Port is open
    - Response : Open | Filtered
- Xmas Scan
    `nmap -sX MACHINE_IP`
    - TCP FIN, PSH, URG set
    - No response : Port is open
    - Response : Open | Filter

**NOTE: These three scan types can be efficient is when scanning a target behind a stateless (non-stateful) firewall.**

- Maimon Scan\
    `nmap -sM MACHINE_IP`
    - TCP FIN,ACK flag set
    - Response : Close
    - Certain BSD-derived systems drop the packet if open port

- ACK Scan\
    `nmap -sA MACHINE_IP`
    - Response : RST regardless of the state of the port
    - Helpful if there is a **firewall** in front of the target. 
    - Suitable to discover firewall rule sets and configuration
    - firewall is blocking all other ports except for these listed ports as **unfiltered**

- Window Scan\
    `nmap -sA MACHINE_AP`
    - Similar to ACK, Uses Window flag
    - Response :  RST regardless of the state of the port
    - System with no firewall will not provide much information.
    - Window scan pointed that three ports are detected as closed i.e filtered by firewall

**NOTE: ACK scan and the window scan were very efficient at helping us map out the firewall rules, But that dose not necessarily mean port is listening. Rule may be old or not updated."
- Custom Scan\
    `nmap -scanflags RSTSYNFIN MACHINE_IP`



#### Spoofing and Decoy

- Spoofing\
    `nmap -S SPOOFED_IP TARGET_IP`
    - It will be useless if the attacker system cannot monitor the network for responses. \
    `nmap -e NET_INTERFACE -Pn -S SPOOFED_IP 10.10.144.95`
    - Specify Interface and not expect ping reply
    - --spoof-mac SPOOFED_MAC ( Speefed MAC Address)
    - Can be used in minimum cases
- Decoy\
    `nmap -D 10.10.0.1,10.10.0.2,ME 10.10.144.95`
    - Make it more challenging to be pinpointed.
    - Scan appear to be coming from many IP addresses so that the attackerâ€™s IP address would be lost among them

#### Fragmented Packets
- Nmap provides the option -f to fragment packets. 
- Divided into * bytes or less
- mtu : change value
- -f = 8 bytes
- -ff = 16 bytes\
`e.g. sudo nmap -sS -p80 -f 10.20.30.144 `
- Increase size: --data-length NUM




